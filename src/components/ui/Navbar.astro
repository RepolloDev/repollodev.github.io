---
import Logo from "./Logo.astro";
import ThemeChanger from "../actions/ThemeChanger.astro";
import LangChanger from "../actions/LangChanger.astro";
import HamburgerButton from "./HamburgerButton.astro";
import { getLangFromUrl, useTranslations } from "@/i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const options = t("nav") as Record<string, string>;
---

<header
  class="navbar bg-base-100 flex-wrap md:flex-nowrap sticky top-0 border-b-[1px] border-neutral z-50 mb-4"
>
  <div>
    <a href={`/${lang}/`}>
      <Logo />
    </a>
  </div>
  <nav
    class="nav order-1 w-full overflow-hidden absolute top-16 left-0 transition-all shadow-lg lg:static lg:shadow-none lg:order-none"
  >
    <ul
      class="nav-links menu lg:menu-horizontal lg:flex-nowrap lg:py-0 w-full bg-base-200 lg:bg-transparent border-b-[1px] lg:border-none border-neutral justify-center max-md:px-8 max-lg:px-16"
    >
      <li>
        <a class="nav-link" href="#experience">
          <span class="iconify ph--suitcase-duotone"></span>
          <span>{options.experience}</span>
        </a>
      </li>
      <li>
        <a class="nav-link" href="#projects">
          <span class="iconify ph--rocket-launch-duotone"></span>
          <span>{options.projects}</span>
        </a>
      </li>
      <li>
        <a class="nav-link" href="#about">
          <span class="iconify ph--user-check-duotone"></span>
          <span>{options.about}</span>
        </a>
      </li>
      <li>
        <a class="nav-link" href="mailto:miduga@gmail.com">
          <span class="iconify ph--mailbox-duotone"></span>
          <span>{options.contact}</span>
        </a>
      </li>
    </ul>
  </nav>
  <div class="actions ml-auto">
    <ul class="flex gap-1.5 md:gap-2 lg:gap-4 items-center">
      <li>
        <ThemeChanger />
      </li>
      <li>
        <LangChanger />
      </li>
      <li>
        <HamburgerButton id="nav-button" />
      </li>
    </ul>
  </div>
</header>

<script>
  const navController = document.getElementById(
    "nav-button"
  ) as HTMLInputElement;
  const nav = document.querySelector(".navbar .nav") as HTMLElement;

  navController?.addEventListener("change", () => {
    nav?.classList.toggle("active");
  });

  nav?.addEventListener("click", () => {
    nav?.classList.remove("active");
    navController.checked = false;
  });
</script>

<style>
  .nav {
    visibility: hidden;
    opacity: 0;
    transform-origin: top;
    --tw-scale-x: 0.95;
    --tw-scale-y: 0.95;
    transform: translate(var(--tw-translate-x), var(--tw-translate-y))
      rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y))
      scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
  }

  @media (min-width: 1024px) {
    .nav {
      visibility: visible;
      opacity: 1;
      transform: none;
    }
  }

  .active {
    visibility: visible;
    opacity: 1;
    transform: none;
  }
</style>
